A pyramid whose base is a regular $n$-sided polygon, whose apex is
directly above the centre of the base, has total surface area $nA+B$,
where $A$ is the area of one of the slanting faces, and $B$ is the area
of the base.

The area of a regular n-gon is
$$\frac{1}{4} x^2 n \tan (90 - \frac{180}{n} ) ,$$ where $x$ is the
length of one of its edges - so this is the area of the base.

And the face height of a pyramid is
$$f = \sqrt{h^2 + \frac{1}{4} x^2 \tan ^2 (90 - \frac{180}{n} ) } ,$$
where $h$ is the height of the pyramid.

So each face has area $xf/2$ (half base $\times$ height).

Putting all of these pieces together, the total area of the pyramid is:
$$\frac{n}{2}x \sqrt{h^2 + \frac{1}{4} x^2 \tan ^2 \theta }
+ \frac{1}{4} x^2 n \tan \theta ,$$ where
$ \theta = 90 - \frac{180}{n}. $
